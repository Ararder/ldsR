[{"path":"http://arvidharder.com/ldsR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Arvid Harder. Maintainer.","code":""},{"path":"http://arvidharder.com/ldsR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"harder (2024). ldsR: R implementation LDscore regression (LDSC). R package version 0.1.0, http://arvidharder.com/ldsR/, https://github.com/Ararder/ldsR.","code":"@Manual{,   title = {ldsR: An R implementation of LDscore regression (LDSC)},   author = {Arvid harder},   year = {2024},   note = {R package version 0.1.0, http://arvidharder.com/ldsR/},   url = {https://github.com/Ararder/ldsR}, }"},{"path":"http://arvidharder.com/ldsR/index.html","id":"ldsr","dir":"","previous_headings":"","what":"An R implementation of LDscore regression (LDSC)","title":"An R implementation of LDscore regression (LDSC)","text":"goal ldsR …","code":""},{"path":"http://arvidharder.com/ldsR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"An R implementation of LDscore regression (LDSC)","text":"can install development version ldsR GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"Ararder/ldsR\")"},{"path":"http://arvidharder.com/ldsR/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"An R implementation of LDscore regression (LDSC)","text":"basic example shows solve common problem:","code":"library(ldsR) ## basic example code"},{"path":"http://arvidharder.com/ldsR/reference/celltype_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform cell-type analysis using partitioned heritability — celltype_analysis","title":"Perform cell-type analysis using partitioned heritability — celltype_analysis","text":"common usage partitioned heritability estimate enrichment significance annotation typical specific cell-type. analysis, useful adjust baseline set annotations, estimate association large set annotations (\"cell-types\")","code":""},{"path":"http://arvidharder.com/ldsR/reference/celltype_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform cell-type analysis using partitioned heritability — celltype_analysis","text":"","code":"celltype_analysis(sumstat, covariate_dir, ldscore_dir, weights = NULL)"},{"path":"http://arvidharder.com/ldsR/reference/celltype_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform cell-type analysis using partitioned heritability — celltype_analysis","text":"covariate_dir directory containing files ld.parquet annot.parquet","code":""},{"path":"http://arvidharder.com/ldsR/reference/celltype_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform cell-type analysis using partitioned heritability — celltype_analysis","text":"dplyr::tibble()","code":""},{"path":"http://arvidharder.com/ldsR/reference/celltype_analysis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perform cell-type analysis using partitioned heritability — celltype_analysis","text":"","code":"if (FALSE) { # \\dontrun{ celltype_analysis(ss_tbl, \"/path/to_baseline\", \"path/to/celltype_ldscores\") } # }"},{"path":"http://arvidharder.com/ldsR/reference/ldsc_h2.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate SNP heritability using LDscore regression for a single annotation — ldsc_h2","title":"Estimate SNP heritability using LDscore regression for a single annotation — ldsc_h2","text":"R implementation LD score regression method estimate SNP heritability, mimicking ldsc --h2 ldsc package. LDscores European subset 1000g (2015 release) 1,290,028 HapMap3 SNPs (1,173,569 SNPs freq > 5%) bundled within ldsR package used default. corresponds eur_w_ld_chr folder previously shared LDSC github. can inspect LDscores used default: arrow::read_parquet(system.file(\"extdata\", \"eur_w_ld.parquet\", package = \"ldsR\")) ldsc_h2 perform quality control input summary statistics, except merge 1,290,028 HapMap3 SNPs reference panel. See munge() function mimic munge_sumstats.py function.","code":""},{"path":"http://arvidharder.com/ldsR/reference/ldsc_h2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate SNP heritability using LDscore regression for a single annotation — ldsc_h2","text":"","code":"ldsc_h2(sumstat, weights = NULL, M = NULL, n_blocks = 200)"},{"path":"http://arvidharder.com/ldsR/reference/ldsc_h2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate SNP heritability using LDscore regression for a single annotation — ldsc_h2","text":"sumstat dplyr::tibble() columns SNP, Z N weights Optional, data.frame tbl columns SNP, L2 M Optional, number SNPs reference panel n_blocks Number blocks use jackknife estimator","code":""},{"path":"http://arvidharder.com/ldsR/reference/ldsc_h2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate SNP heritability using LDscore regression for a single annotation — ldsc_h2","text":"dplyr::tibble() columns h2 h2_se","code":""},{"path":"http://arvidharder.com/ldsR/reference/ldsc_h2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate SNP heritability using LDscore regression for a single annotation — ldsc_h2","text":"","code":"p <- system.file(\"extdata\", \"eur_w_ld.parquet\", package = \"ldsR\") snps <- arrow::read_parquet(p, col_select = c(\"SNP\")) snps$N <- 130000 snps$Z <- rnorm(nrow(snps)) ldsc_h2(snps) #> # A tibble: 1 × 6 #>          h2   h2_se   int  int_se mean_chi2 lambda_gc #>       <dbl>   <dbl> <dbl>   <dbl>     <dbl>     <dbl> #> 1 -0.000113 0.00110  1.00 0.00312     0.999     0.996"},{"path":"http://arvidharder.com/ldsR/reference/ldsc_rg.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the genetic correlation between two traits — ldsc_rg","title":"Compute the genetic correlation between two traits — ldsc_rg","text":"Compute genetic correlation two traits","code":""},{"path":"http://arvidharder.com/ldsR/reference/ldsc_rg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the genetic correlation between two traits — ldsc_rg","text":"","code":"ldsc_rg(sumstats1, sumstats2, weights = NULL, M = NULL, n_blocks = 200)"},{"path":"http://arvidharder.com/ldsR/reference/ldsc_rg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the genetic correlation between two traits — ldsc_rg","text":"sumstats1 dplyr::tibble() atleast columns SNP, A1, A2, Z, N. perform quality checks, use munge() running ldsc_rg() sumstats2 dplyr::tibble() atleast columns SNP, A1, A2, Z, N. estimate rG sumstats1 several traits, wrap data.frames list. names lost, column trait2 correspond index list. Use named list retain names trait2 column list(dataframe1, dataframe2, ...) weights Optional, data.frame tbl columns SNP, L2 M Optional, number SNPs reference panel n_blocks Number blocks use jackknife estimator","code":""},{"path":"http://arvidharder.com/ldsR/reference/ldsc_rg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the genetic correlation between two traits — ldsc_rg","text":"dplyr::tibble()","code":""},{"path":"http://arvidharder.com/ldsR/reference/ldsc_rg.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the genetic correlation between two traits — ldsc_rg","text":"","code":"path <- system.file(\"extdata\", \"eur_w_ld.parquet\", package = \"ldsR\") snps <- arrow::read_parquet(path, col_select = c(\"SNP\")) # to make example faster snps <- dplyr::slice_head(snps, n = 100000) snps$A1 <- \"A\" snps$A2 <-  snps$N <- 130000 snps$Z <- rnorm(nrow(snps)) snps2 <- snps snps2$N <- 75000 snps2$Z <- rnorm(nrow(snps)) ldsc_rg(snps, snps2) #> ! 0 SNPs were removed when merging summary statistics #> Warning: NaNs produced #> Warning: NaNs produced #> # A tibble: 1 × 14 #>   trait2    rg rg_se h2_trait1 h2_trait_se h2_trait2 h2_trait2_se     gcov #>    <int> <dbl> <dbl>     <dbl>       <dbl>     <dbl>        <dbl>    <dbl> #> 1      1   NaN    NA  0.000682     0.00392  -0.00572      0.00633 0.000787 #> # ℹ 6 more variables: gcov_se <dbl>, gcov_int <dbl>, gcov_int_se <dbl>, #> #   mean_z1z2 <dbl>, z <dbl>, p <dbl> # to run estimate the genetic correlations for many traits, wrap s2 in a list # ldsc_rg(snps, list(snps2, snps2)) # use a named list to create the `trait2` column in the output # ldsc_rg(snps, list(\"trait2\" = s2, \"trait3\" = s3, \"trait4\" = s4))"},{"path":"http://arvidharder.com/ldsR/reference/munge.html","id":null,"dir":"Reference","previous_headings":"","what":"Munge GWAS summary statistics — munge","title":"Munge GWAS summary statistics — munge","text":"Munge GWAS summary statistics","code":""},{"path":"http://arvidharder.com/ldsR/reference/munge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Munge GWAS summary statistics — munge","text":"","code":"munge(dset, info_filter = 0.9, maf_filter = 0.01)"},{"path":"http://arvidharder.com/ldsR/reference/munge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Munge GWAS summary statistics — munge","text":"dset dplyr::tibble() columns SNP, A1 A2 Z N possibly EAF INFO info_filter INFO score filter threshold remove rows maf_filter Minor allele frequenc filter remove rows","code":""},{"path":"http://arvidharder.com/ldsR/reference/munge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Munge GWAS summary statistics — munge","text":"data.frame","code":""},{"path":"http://arvidharder.com/ldsR/reference/munge.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Munge GWAS summary statistics — munge","text":"","code":"if (FALSE) { # \\dontrun{ parse_gwas(tbl) } # }"},{"path":"http://arvidharder.com/ldsR/reference/parse_gwas.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse a GWAS summary statistics — parse_gwas","title":"Parse a GWAS summary statistics — parse_gwas","text":"Parse GWAS summary statistics","code":""},{"path":"http://arvidharder.com/ldsR/reference/parse_gwas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse a GWAS summary statistics — parse_gwas","text":"","code":"parse_gwas(df)"},{"path":"http://arvidharder.com/ldsR/reference/parse_gwas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse a GWAS summary statistics — parse_gwas","text":"df memory base::data.frame() filepath ldsc-munged summary statistics file filepath tidyGWAS folder.","code":""},{"path":"http://arvidharder.com/ldsR/reference/parse_gwas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse a GWAS summary statistics — parse_gwas","text":"dplyr::tibble() columns SNP, A1, A2, Z, N","code":""},{"path":"http://arvidharder.com/ldsR/reference/parse_gwas.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parse a GWAS summary statistics — parse_gwas","text":"","code":"if (FALSE) { # \\dontrun{ parse_gwas(tbl) } # }"},{"path":"http://arvidharder.com/ldsR/reference/partitioned_h2.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate partitioned SNP heritability — partitioned_h2","title":"Estimate partitioned SNP heritability — partitioned_h2","text":"R implementation LD score regression method estimate SNP heritability, mimicking ldsc --h2 ldsc package. partitioned heritablity, noMHC weights used instead eur_w_ld_chr weights. can inspect LDscores used default, column L2_celltype arrow::read_parquet(system.file(\"extdata\", \"eur_w_ld.parquet\", package = \"ldsR\")) partitioned_heritability perform quality control input summary statistics, except merge SNPs reference panel. See munge() function mimic munge_sumstats.py function.","code":""},{"path":"http://arvidharder.com/ldsR/reference/partitioned_h2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate partitioned SNP heritability — partitioned_h2","text":"","code":"partitioned_h2(sumstat, ldscore_dir, weights = NULL, n_blocks = 200)"},{"path":"http://arvidharder.com/ldsR/reference/partitioned_h2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate partitioned SNP heritability — partitioned_h2","text":"sumstat dplyr::tibble() columns SNP, Z N ldscore_dir filepath directory annot.parquet ldscores.parquet files weights Optional, data.frame tbl columns SNP, L2 n_blocks Number blocks use jackknife estimator","code":""},{"path":"http://arvidharder.com/ldsR/reference/partitioned_h2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate partitioned SNP heritability — partitioned_h2","text":"dplyr::tibble()","code":""},{"path":"http://arvidharder.com/ldsR/reference/partitioned_h2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate partitioned SNP heritability — partitioned_h2","text":"","code":"if (FALSE) { # \\dontrun{ partitioned_heritability(sumstats, \"path/to_dir/\") } # }"}]
