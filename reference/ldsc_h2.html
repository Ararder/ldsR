<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate SNP heritability using LDscore regression — ldsc_h2 • ldsR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate SNP heritability using LDscore regression — ldsc_h2"><meta name="description" content='An R implementation of the LD score regression method to estimate SNP heritability,
mimicking ldsc --h2 from the ldsc package.
LDscores for the European subset of 1000g (2015 release) for 1,290,028 HapMap3 SNPs (with 1,173,569 SNPs with freq &amp;gt; 5%)
are bundled within the ldsR package and are used by default. This corresponds to the eur_w_ld_chr folder
previously shared at the LDSC github.
You can inspect the LDscores used by default:
arrow::read_parquet(system.file("extdata", "eur_w_ld.parquet", package = "ldsR"))
ldsc_h2 does not perform any quality control on the input summary statistics, except to merge with the
1,290,028 HapMap3 SNPs in the reference panel. See the munge() function to mimic the munge_sumstats.py function.'><meta property="og:description" content='An R implementation of the LD score regression method to estimate SNP heritability,
mimicking ldsc --h2 from the ldsc package.
LDscores for the European subset of 1000g (2015 release) for 1,290,028 HapMap3 SNPs (with 1,173,569 SNPs with freq &amp;gt; 5%)
are bundled within the ldsR package and are used by default. This corresponds to the eur_w_ld_chr folder
previously shared at the LDSC github.
You can inspect the LDscores used by default:
arrow::read_parquet(system.file("extdata", "eur_w_ld.parquet", package = "ldsR"))
ldsc_h2 does not perform any quality control on the input summary statistics, except to merge with the
1,290,028 HapMap3 SNPs in the reference panel. See the munge() function to mimic the munge_sumstats.py function.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ldsR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Ararder/ldsR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate SNP heritability using LDscore regression</h1>
      <small class="dont-index">Source: <a href="https://github.com/Ararder/ldsR/blob/main/R/h2.R" class="external-link"><code>R/h2.R</code></a></small>
      <div class="d-none name"><code>ldsc_h2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>An R implementation of the LD score regression method to estimate SNP heritability,
mimicking <code>ldsc --h2</code> from the <a href="https://github.com/bulik/ldsc/wiki/Heritability-and-Genetic-Correlation" class="external-link">ldsc</a> package.</p>
<p>LDscores for the European subset of 1000g (2015 release) for 1,290,028 HapMap3 SNPs (with 1,173,569 SNPs with freq &gt; 5%)
are bundled within the ldsR package and are used by default. This corresponds to the <code>eur_w_ld_chr</code> folder
previously shared at the LDSC <a href="https://github.com/bulik/ldsc" class="external-link">github</a>.</p>
<p>You can inspect the LDscores used by default:
<code>arrow::read_parquet(system.file("extdata", "eur_w_ld.parquet", package = "ldsR"))</code></p>
<p>ldsc_h2 does not perform any quality control on the input summary statistics, except to merge with the
1,290,028 HapMap3 SNPs in the reference panel. See the <code><a href="munge.html">munge()</a></code> function to mimic the <code>munge_sumstats.py</code> function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ldsc_h2</span><span class="op">(</span><span class="va">sumstat</span>, weights <span class="op">=</span> <span class="cn">NULL</span>, M <span class="op">=</span> <span class="cn">NULL</span>, n_blocks <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sumstat">sumstat<a class="anchor" aria-label="anchor" href="#arg-sumstat"></a></dt>
<dd><p>A data.frame or tbl with columns <code>SNP</code>, <code>Z</code> and <code>N</code></p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>Optional, a data.frame or tbl with columns <code>SNP</code>, <code>L2</code></p></dd>


<dt id="arg-m">M<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>Optional, the number of SNPs in the reference panel</p></dd>


<dt id="arg-n-blocks">n_blocks<a class="anchor" aria-label="anchor" href="#arg-n-blocks"></a></dt>
<dd><p>Number of blocks to use for the jackknife estimator</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a <code><a href="https://dplyr.tidyverse.org/reference/reexports.html" class="external-link">dplyr::tibble()</a></code> with columns <code>h2</code> and <code>h2_se</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"eur_w_ld.parquet"</span>, package <span class="op">=</span> <span class="st">"ldsR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">snps</span> <span class="op">&lt;-</span> <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html" class="external-link">read_parquet</a></span><span class="op">(</span><span class="va">p</span>, col_select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SNP"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">snps</span><span class="op">$</span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">130000</span></span></span>
<span class="r-in"><span><span class="va">snps</span><span class="op">$</span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">snps</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ldsc_h2</span><span class="op">(</span><span class="va">snps</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          h2   h2_se   int  int_se mean_chi2 lambda_gc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">113</span> 0.001<span style="text-decoration: underline;">10</span>  1.00 0.003<span style="text-decoration: underline;">12</span>     0.999     0.996</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Arvid Harder.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

